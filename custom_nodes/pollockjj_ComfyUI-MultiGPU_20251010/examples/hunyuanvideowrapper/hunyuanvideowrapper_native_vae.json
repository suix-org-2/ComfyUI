{
  "last_node_id": 51,
  "last_link_id": 70,
  "nodes": [
    {
      "id": 7,
      "type": "HyVideoVAELoader",
      "pos": [
        -980.2922973632812,
        -830.076171875
      ],
      "size": [
        379.166748046875,
        82
      ],
      "flags": {},
      "order": 0,
      "mode": 4,
      "inputs": [
        {
          "name": "compile_args",
          "type": "COMPILEARGS",
          "link": null,
          "shape": 7
        }
      ],
      "outputs": [
        {
          "name": "vae",
          "type": "VAE",
          "links": [],
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "HyVideoVAELoader"
      },
      "widgets_values": [
        "hunyuan_video_vae_bf16.safetensors",
        "bf16"
      ],
      "color": "#332922",
      "bgcolor": "#593930"
    },
    {
      "id": 30,
      "type": "HyVideoTextEncode",
      "pos": [
        -194.8070831298828,
        -79.95932006835938
      ],
      "size": [
        425.64068603515625,
        286.85968017578125
      ],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {
          "name": "text_encoders",
          "type": "HYVIDTEXTENCODER",
          "link": 66
        },
        {
          "name": "custom_prompt_template",
          "type": "PROMPT_TEMPLATE",
          "link": null,
          "shape": 7
        },
        {
          "name": "clip_l",
          "type": "CLIP",
          "link": null,
          "shape": 7
        },
        {
          "name": "hyvid_cfg",
          "type": "HYVID_CFG",
          "link": null,
          "shape": 7
        }
      ],
      "outputs": [
        {
          "name": "hyvid_embeds",
          "type": "HYVIDEMBEDS",
          "links": [
            36
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "HyVideoTextEncode"
      },
      "widgets_values": [
        "A serene Minnesota lake stretches out at sunset, the water's surface a mirror reflecting the vibrant orange and pink sky. In the foreground, a pair of loons glide gracefully across the water, their sleek black and white feathers contrasting with the warm hues of the sunset. The loons' long, slender necks curve elegantly as they dip their heads into the water, searching for fish. The camera pans slowly from left to right, capturing the tranquil scene. The shoreline is visible in the distance, lined with tall pine trees that cast long shadows across the water. The loons' haunting calls echo across the lake, adding to the peaceful atmosphere.",
        false,
        "video"
      ]
    },
    {
      "id": 49,
      "type": "DownloadAndLoadHyVideoTextEncoderMultiGPU",
      "pos": [
        -745.2869262695312,
        -80.3648452758789
      ],
      "size": [
        516.5999755859375,
        202
      ],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "hyvid_text_encoder",
          "type": "HYVIDTEXTENCODER",
          "links": [
            66
          ],
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "DownloadAndLoadHyVideoTextEncoderMultiGPU"
      },
      "widgets_values": [
        "Kijai/llava-llama-3-8b-text-encoder-tokenizer",
        "disabled",
        "bf16",
        false,
        2,
        "disabled",
        "cuda:1"
      ],
      "color": "#233",
      "bgcolor": "#355"
    },
    {
      "id": 48,
      "type": "HyVideoModelLoaderMultiGPU",
      "pos": [
        -338.0295715332031,
        -403.1601257324219
      ],
      "size": [
        497.3603210449219,
        252.03509521484375
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [
        {
          "name": "compile_args",
          "type": "COMPILEARGS",
          "link": null,
          "shape": 7
        },
        {
          "name": "block_swap_args",
          "type": "BLOCKSWAPARGS",
          "link": null,
          "shape": 7
        },
        {
          "name": "lora",
          "type": "HYVIDLORA",
          "link": null,
          "shape": 7
        }
      ],
      "outputs": [
        {
          "name": "model",
          "type": "HYVIDEOMODEL",
          "links": [
            65
          ],
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "HyVideoModelLoaderMultiGPU"
      },
      "widgets_values": [
        "hunyuan_video_720_cfgdistill_fp8_e4m3fn.safetensors",
        "fp32",
        "fp8_e4m3fn",
        "main_device",
        "sdpa",
        false,
        "cuda:0"
      ],
      "color": "#233",
      "bgcolor": "#355"
    },
    {
      "id": 16,
      "type": "DownloadAndLoadHyVideoTextEncoder",
      "pos": [
        -1011.1117553710938,
        -1076.6143798828125
      ],
      "size": [
        441,
        178
      ],
      "flags": {},
      "order": 3,
      "mode": 4,
      "inputs": [],
      "outputs": [
        {
          "name": "hyvid_text_encoder",
          "type": "HYVIDTEXTENCODER",
          "links": []
        }
      ],
      "properties": {
        "Node name for S&R": "DownloadAndLoadHyVideoTextEncoder"
      },
      "widgets_values": [
        "Kijai/llava-llama-3-8b-text-encoder-tokenizer",
        "openai/clip-vit-large-patch14",
        "fp16",
        false,
        2,
        "disabled"
      ],
      "color": "#332922",
      "bgcolor": "#593930"
    },
    {
      "id": 1,
      "type": "HyVideoModelLoader",
      "pos": [
        -557.619384765625,
        -1092.4908447265625
      ],
      "size": [
        435.37628173828125,
        221.34506225585938
      ],
      "flags": {},
      "order": 4,
      "mode": 4,
      "inputs": [
        {
          "name": "compile_args",
          "type": "COMPILEARGS",
          "link": null,
          "shape": 7
        },
        {
          "name": "block_swap_args",
          "type": "BLOCKSWAPARGS",
          "link": null,
          "shape": 7
        },
        {
          "name": "lora",
          "type": "HYVIDLORA",
          "link": null,
          "shape": 7
        }
      ],
      "outputs": [
        {
          "name": "model",
          "type": "HYVIDEOMODEL",
          "links": [],
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "HyVideoModelLoader"
      },
      "widgets_values": [
        "hunyuan_video_720_cfgdistill_fp8_e4m3fn.safetensors",
        "bf16",
        "fp8_e4m3fn",
        "main_device",
        "sdpa",
        false
      ],
      "color": "#332922",
      "bgcolor": "#593930"
    },
    {
      "id": 34,
      "type": "VHS_VideoCombine",
      "pos": [
        847.0758666992188,
        -415.1882629394531
      ],
      "size": [
        580.7774658203125,
        698.4859008789062
      ],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 69
        },
        {
          "name": "audio",
          "type": "AUDIO",
          "link": null,
          "shape": 7
        },
        {
          "name": "meta_batch",
          "type": "VHS_BatchManager",
          "link": null,
          "shape": 7
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": null,
          "shape": 7
        }
      ],
      "outputs": [
        {
          "name": "Filenames",
          "type": "VHS_FILENAMES",
          "links": null
        }
      ],
      "properties": {
        "Node name for S&R": "VHS_VideoCombine"
      },
      "widgets_values": {
        "frame_rate": 24,
        "loop_count": 0,
        "filename_prefix": "HunyuanVideo",
        "format": "video/h264-mp4",
        "pix_fmt": "yuv420p",
        "crf": 19,
        "save_metadata": true,
        "trim_to_audio": false,
        "pingpong": false,
        "save_output": true,
        "videopreview": {
          "hidden": false,
          "paused": false,
          "params": {
            "filename": "HunyuanVideo_00161.mp4",
            "subfolder": "",
            "type": "output",
            "format": "video/h264-mp4",
            "frame_rate": 24,
            "workflow": "HunyuanVideo_00161.png",
            "fullpath": "/home/johnj/ComfyUI/output/HunyuanVideo_00161.mp4"
          },
          "muted": false
        }
      }
    },
    {
      "id": 45,
      "type": "VAEDecodeTiled",
      "pos": [
        532.4385986328125,
        -644.8389282226562
      ],
      "size": [
        315,
        150
      ],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 70
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 56
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            69
          ],
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "VAEDecodeTiled"
      },
      "widgets_values": [
        256,
        64,
        64,
        8
      ]
    },
    {
      "id": 44,
      "type": "VAELoaderMultiGPU",
      "pos": [
        -230.99607849121094,
        -639.45654296875
      ],
      "size": [
        315,
        82
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "VAE",
          "type": "VAE",
          "links": [
            56
          ],
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "VAELoaderMultiGPU"
      },
      "widgets_values": [
        "hunyuan_video_vae_bf16.safetensors",
        "cuda:1"
      ],
      "color": "#233",
      "bgcolor": "#355"
    },
    {
      "id": 47,
      "type": "HyVideoVAELoaderMultiGPU",
      "pos": [
        -512.9594116210938,
        -822.8096313476562
      ],
      "size": [
        315,
        106
      ],
      "flags": {},
      "order": 6,
      "mode": 4,
      "inputs": [
        {
          "name": "compile_args",
          "type": "COMPILEARGS",
          "link": null,
          "shape": 7
        }
      ],
      "outputs": [
        {
          "name": "vae",
          "type": "VAE",
          "links": [
            64
          ],
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "HyVideoVAELoaderMultiGPU"
      },
      "widgets_values": [
        "hunyuan_video_vae_bf16.safetensors",
        "bf16",
        "cuda:1"
      ],
      "color": "#233",
      "bgcolor": "#355"
    },
    {
      "id": 5,
      "type": "HyVideoDecode",
      "pos": [
        -106.15780639648438,
        -843.2271728515625
      ],
      "size": [
        345.4285888671875,
        150
      ],
      "flags": {},
      "order": 9,
      "mode": 4,
      "inputs": [
        {
          "name": "vae",
          "type": "VAE",
          "link": 64
        },
        {
          "name": "samples",
          "type": "LATENT",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "links": [],
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "HyVideoDecode"
      },
      "widgets_values": [
        true,
        86,
        256,
        true
      ]
    },
    {
      "id": 3,
      "type": "HyVideoSampler",
      "pos": [
        255.96482849121094,
        -403.58502197265625
      ],
      "size": [
        315,
        630
      ],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "HYVIDEOMODEL",
          "link": 65
        },
        {
          "name": "hyvid_embeds",
          "type": "HYVIDEMBEDS",
          "link": 36
        },
        {
          "name": "samples",
          "type": "LATENT",
          "link": null,
          "shape": 7
        },
        {
          "name": "stg_args",
          "type": "STGARGS",
          "link": null,
          "shape": 7
        },
        {
          "name": "context_options",
          "type": "COGCONTEXT",
          "link": null,
          "shape": 7
        },
        {
          "name": "feta_args",
          "type": "FETAARGS",
          "link": null,
          "shape": 7
        },
        {
          "name": "teacache_args",
          "type": "TEACACHEARGS",
          "link": null,
          "shape": 7
        }
      ],
      "outputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "links": [
            70
          ],
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "HyVideoSampler"
      },
      "widgets_values": [
        512,
        320,
        85,
        20,
        6,
        9,
        5770521,
        "fixed",
        false,
        1,
        "FlowMatchDiscreteScheduler"
      ]
    },
    {
      "id": 51,
      "type": "Note",
      "pos": [
        449.2930908203125,
        -955.3724975585938
      ],
      "size": [
        1160.6077880859375,
        211.52166748046875
      ],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {},
      "widgets_values": [
        "kijai already does an impressive amount of memory management in these nodes, so it is important for MultiGPU to \"play nice\" and vice-versa.\n\nFor this version of the workflow:\n\n• Only two of kijai's three nodes are used - model and text. For VAE we relying on Comfy's native VAE Loader node wrapped by MultiGPU.\n\n• HunyuanVideo TextEncode: \"force_offload\" is set to \"false\". Setting this option to \"true\" would  defeat the purpose of selecting a different main_device to load to.\n\n• The main model and VAE devices are set to different cuda devices (cuda0 and cuda1). This is possible because the HunyuanVideo Sampler node outputs latents compatible with Comfy's native TiledVAE Decode.\n• Consequentially, now that we no longer have any other component on cuda0, we set \"force_offload\" to \"false\" on the \"HunyuanVideo Sampler\" node. This keeps the main model in VRAM, eliminating load times for the subsequent generations.\n\n**NOTE** This the **OPTIMAL** way to use MultiGPU with kijai's awesome nodes. If you want to use all three of kijai's loader nodes, please see device_selector_lowvram_flux_controlnet.json in ./examples"
      ],
      "color": "#432",
      "bgcolor": "#653"
    }
  ],
  "links": [
    [
      36,
      30,
      0,
      3,
      1,
      "HYVIDEMBEDS"
    ],
    [
      56,
      44,
      0,
      45,
      1,
      "VAE"
    ],
    [
      64,
      47,
      0,
      5,
      0,
      "VAE"
    ],
    [
      65,
      48,
      0,
      3,
      0,
      "HYVIDEOMODEL"
    ],
    [
      66,
      49,
      0,
      30,
      0,
      "HYVIDTEXTENCODER"
    ],
    [
      69,
      45,
      0,
      34,
      0,
      "IMAGE"
    ],
    [
      70,
      3,
      0,
      45,
      0,
      "LATENT"
    ]
  ],
  "groups": [],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.8769226950001201,
      "offset": [
        895.3038892918638,
        1121.109618095784
      ]
    },
    "ue_links": [],
    "VHS_latentpreview": false,
    "VHS_latentpreviewrate": 0
  },
  "version": 0.4
}